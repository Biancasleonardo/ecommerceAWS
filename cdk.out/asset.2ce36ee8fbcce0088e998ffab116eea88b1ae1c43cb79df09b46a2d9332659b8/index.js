"use strict";var re=Object.create;var P=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var ue=Object.getOwnPropertyNames;var ae=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty;var s=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ne=(e,t)=>{for(var r in t)P(e,r,{get:t[r],enumerable:!0})},S=(e,t,r,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ue(t))!de.call(e,a)&&a!==r&&P(e,a,{get:()=>t[a],enumerable:!(u=te(t,a))||u.enumerable});return e};var oe=(e,t,r)=>(r=e!=null?re(ae(e)):{},S(t||!e||!e.__esModule?P(r,"default",{value:e,enumerable:!0}):r,e)),ie=e=>S(P({},"__esModule",{value:!0}),e);var O=s(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.default=ce;var se=fe(require("crypto"));function fe(e){return e&&e.__esModule?e:{default:e}}function ce(){return se.default.randomBytes(16)}});var h=s(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.default=void 0;var G=[];for(_=0;_<256;++_)G[_]=(_+256).toString(16).substr(1);var _;function le(e,t){var r=t||0,u=G;return[u[e[r++]],u[e[r++]],u[e[r++]],u[e[r++]],"-",u[e[r++]],u[e[r++]],"-",u[e[r++]],u[e[r++]],"-",u[e[r++]],u[e[r++]],"-",u[e[r++]],u[e[r++]],u[e[r++]],u[e[r++]],u[e[r++]],u[e[r++]]].join("")}var ve=le;x.default=ve});var B=s(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.default=void 0;var _e=k(O()),me=k(h());function k(e){return e&&e.__esModule?e:{default:e}}var L,E,N=0,U=0;function pe(e,t,r){var u=t&&r||0,a=t||[];e=e||{};var d=e.node||L,n=e.clockseq!==void 0?e.clockseq:E;if(d==null||n==null){var i=e.random||(e.rng||_e.default)();d==null&&(d=L=[i[0]|1,i[1],i[2],i[3],i[4],i[5]]),n==null&&(n=E=(i[6]<<8|i[7])&16383)}var f=e.msecs!==void 0?e.msecs:new Date().getTime(),o=e.nsecs!==void 0?e.nsecs:U+1,c=f-N+(o-U)/1e4;if(c<0&&e.clockseq===void 0&&(n=n+1&16383),(c<0||f>N)&&e.nsecs===void 0&&(o=0),o>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");N=f,U=o,E=n,f+=122192928e5;var p=((f&268435455)*1e4+o)%4294967296;a[u++]=p>>>24&255,a[u++]=p>>>16&255,a[u++]=p>>>8&255,a[u++]=p&255;var y=f/4294967296*1e4&268435455;a[u++]=y>>>8&255,a[u++]=y&255,a[u++]=y>>>24&15|16,a[u++]=y>>>16&255,a[u++]=n>>>8|128,a[u++]=n&255;for(var g=0;g<6;++g)a[u+g]=d[g];return t||(0,me.default)(a)}var ye=pe;q.default=ye});var b=s(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.default=qe;l.URL=l.DNS=void 0;var ge=Pe(h());function Pe(e){return e&&e.__esModule?e:{default:e}}function xe(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(r){t.push(parseInt(r,16))}),t}function he(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}var H="6ba7b810-9dad-11d1-80b4-00c04fd430c8";l.DNS=H;var J="6ba7b811-9dad-11d1-80b4-00c04fd430c8";l.URL=J;function qe(e,t,r){var u=function(a,d,n,i){var f=n&&i||0;if(typeof a=="string"&&(a=he(a)),typeof d=="string"&&(d=xe(d)),!Array.isArray(a))throw TypeError("value must be an array of bytes");if(!Array.isArray(d)||d.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var o=r(d.concat(a));if(o[6]=o[6]&15|t,o[8]=o[8]&63|128,n)for(var c=0;c<16;++c)n[f+c]=o[c];return n||(0,ge.default)(o)};try{u.name=e}catch{}return u.DNS=H,u.URL=J,u}});var K=s(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.default=void 0;var De=Ae(require("crypto"));function Ae(e){return e&&e.__esModule?e:{default:e}}function we(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),De.default.createHash("md5").update(e).digest()}var Ce=we;D.default=Ce});var $=s(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.default=void 0;var Re=V(b()),Me=V(K());function V(e){return e&&e.__esModule?e:{default:e}}var Ie=(0,Re.default)("v3",48,Me.default),Te=Ie;A.default=Te});var W=s(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.default=void 0;var Oe=F(O()),Ee=F(h());function F(e){return e&&e.__esModule?e:{default:e}}function Ne(e,t,r){var u=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||Oe.default)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t)for(var d=0;d<16;++d)t[u+d]=a[d];return t||(0,Ee.default)(a)}var Ue=Ne;w.default=Ue});var z=s(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.default=void 0;var be=Se(require("crypto"));function Se(e){return e&&e.__esModule?e:{default:e}}function Ge(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),be.default.createHash("sha1").update(e).digest()}var Le=Ge;C.default=Le});var X=s(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.default=void 0;var ke=Q(b()),Be=Q(z());function Q(e){return e&&e.__esModule?e:{default:e}}var He=(0,ke.default)("v5",80,Be.default),Je=He;R.default=Je});var Y=s(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});Object.defineProperty(v,"v1",{enumerable:!0,get:function(){return Ke.default}});Object.defineProperty(v,"v3",{enumerable:!0,get:function(){return Ve.default}});Object.defineProperty(v,"v4",{enumerable:!0,get:function(){return $e.default}});Object.defineProperty(v,"v5",{enumerable:!0,get:function(){return Fe.default}});var Ke=M(B()),Ve=M($()),$e=M(W()),Fe=M(X());function M(e){return e&&e.__esModule?e:{default:e}}});var Xe={};ne(Xe,{handler:()=>Qe});module.exports=ie(Xe);var m=oe(Y(),1),ir=m.default.v1,sr=m.default.v3,Z=m.default.v4,fr=m.default.v5;var I=class{constructor(t,r){this.ddbCliente=t,this.productsDdb=r}async getAllProducts(){return console.log("this.ddbCliente:",this.ddbCliente),console.log("this.productsDdb:",this.productsDdb),(await this.ddbCliente.scan({TableName:this.productsDdb}).promise()).Items}async getProductById(t){let r=await this.ddbCliente.get({TableName:this.productsDdb,Key:{id:t}}).promise();if(r.Item)return r.Item;throw new Error("Product not found")}async createProduct(t){return t.id=Z(),await this.ddbCliente.put({TableName:this.productsDdb,Item:t}).promise(),t}async deleteProduct(t){let r=await this.ddbCliente.delete({TableName:this.productsDdb,Key:{id:t},ReturnValues:"ALL_OLD"}).promise();if(r.Attributes)return r.Attributes;throw new Error("Product not found")}async updateProduct(t,r){let u=await this.ddbCliente.update({TableName:this.productsDdb,Key:{id:t},ConditionExpression:"attribute_exists(id)",ReturnValues:"UPDATED_NEW",UpdateExpression:"set productName = :n, code = :c, price = :p, model = :m, productUrl = :u",ExpressionAttributeValues:{":n":r.productName,":c":r.code,":p":r.price,":m":r.model,":u":r.productUrl}}).promise();return u.Attributes.id=t,u.Attributes}};var ee=require("aws-sdk"),We=process.env.PRODUCTS_DDB,ze=new ee.DynamoDB.DocumentClient,j=new I(ze,We);async function Qe(e,t){let r=e.httpMethod,u=t.awsRequestId,a=e.requestContext.requestId;if(console.log(`API Gateway RequestId: ${a} - lambda RequestId: ${u}`),e.resource==="/products"){if(r==="GET"){console.log("GET /products");let d=await j.getAllProducts();return{statusCode:200,body:JSON.stringify(d)}}}else if(e.resource==="/products/{id}"){let d=e.pathParameters.id;console.log(`GET /products/${d}`);try{let n=await j.getProductById(d);return{statusCode:200,body:JSON.stringify(n)}}catch(n){return console.log(n.message),{statusCode:404,body:n.message}}}return{statusCode:400,body:JSON.stringify({message:"Bad request"})}}0&&(module.exports={handler});
